<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Modeling spectral sensitivity — sensmodel • pavo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Modeling spectral sensitivity — sensmodel"><meta name="description" content="Models spectral sensitivity (with oil droplets; optional) based on peak cone
sensitivity according to the models of Govardovskii et al. (2000) and Hart &amp;amp;
Vorobyev (2005)."><meta property="og:description" content="Models spectral sensitivity (with oil droplets; optional) based on peak cone
sensitivity according to the models of Govardovskii et al. (2000) and Hart &amp;amp;
Vorobyev (2005)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pavo</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">2.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pavo.html">Get Started</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://book.colrverse.com"><span class="fa fa-book"></span> Book</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmaia/pavo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Modeling spectral sensitivity</h1>
      <small class="dont-index">Source: <a href="https://github.com/rmaia/pavo/blob/master/R/sensmodel.R" class="external-link"><code>R/sensmodel.R</code></a></small>
      <div class="d-none name"><code>sensmodel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Models spectral sensitivity (with oil droplets; optional) based on peak cone
sensitivity according to the models of Govardovskii et al. (2000) and Hart &amp;
Vorobyev (2005).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sensmodel</span><span class="op">(</span></span>
<span>  <span class="va">peaksens</span>,</span>
<span>  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>,</span>
<span>  lambdacut <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Bmid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oiltype <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  om <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  integrate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sensnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"lmax"</span>, <span class="va">peaksens</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-peaksens">peaksens<a class="anchor" aria-label="anchor" href="#arg-peaksens"></a></dt>
<dd><p>(required) a vector with peak sensitivities for the cones to
model.</p></dd>


<dt id="arg-range">range<a class="anchor" aria-label="anchor" href="#arg-range"></a></dt>
<dd><p>a vector of length 2 for the range over which to calculate the
spectral sensitivities (defaults to 300nm to 700nm).</p></dd>


<dt id="arg-lambdacut">lambdacut<a class="anchor" aria-label="anchor" href="#arg-lambdacut"></a></dt>
<dd><p>a vector of same length as peaksens that lists the cut-off
wavelength value for oil droplets. Needs either <code>Bmid</code> or <code>oiltype</code> to also
be entered. See Hart and Vorobyev (2005).</p></dd>


<dt id="arg-bmid">Bmid<a class="anchor" aria-label="anchor" href="#arg-bmid"></a></dt>
<dd><p>a vector of same length as peaksens that lists the gradient of
line tangent to the absorbance spectrum of the oil droplets. See Hart and
Vorobyev (2005).</p></dd>


<dt id="arg-oiltype">oiltype<a class="anchor" aria-label="anchor" href="#arg-oiltype"></a></dt>
<dd><p>a list of same length as peaksens that lists the oil droplet
types (currently accepts only "T", C", "Y", "R", "P") when Bmid is not
known. Calculates Bmid based on the regression equations found in Hart ad
Vorobyev (2005).</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>logical. If <code>TRUE</code> the sensitivities will include the beta peak
See Govardovskii et al.(2000) (defaults to <code>TRUE</code>).</p></dd>


<dt id="arg-om">om<a class="anchor" aria-label="anchor" href="#arg-om"></a></dt>
<dd><p>a vector of same length as <code>range1</code>-<code>range2</code> that contains ocular
media transmission data. If included, cone sensitivity will be corrected
for ocular media transmission. Currently accepts "bird" using values from
Hart et al. (2005), or user-defined values.</p></dd>


<dt id="arg-integrate">integrate<a class="anchor" aria-label="anchor" href="#arg-integrate"></a></dt>
<dd><p>logical. If <code>TRUE</code>, each curve is transformed to have a
total area under the curve of 1 (best for visual models; defaults to
<code>TRUE</code>). NOTE: integration is applied before any effects of ocular media
are considered, for compatibility with visual model procedures.</p></dd>


<dt id="arg-sensnames">sensnames<a class="anchor" aria-label="anchor" href="#arg-sensnames"></a></dt>
<dd><p>A vector equal in length to <code>peaksens</code>, specifying custom
names for the resulting sensitivity curves (e.g. c('s', 'm', 'l') for
short-, medium- and long-wavelength sensitive receptors.)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of class <code>rspec</code> containing each cone model as a column.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Govardovskii VI, Fyhrquist N, Reuter T, Kuzmin DG and Donner K.
2000. In search of the visual pigment template. Visual Neuroscience
17:509-528, <a href="https://doi.org/10.1017/S0952523800174036" class="external-link">doi:10.1017/S0952523800174036</a></p>
<p>Hart NS, and Vorobyev M. 2005. Modeling oil droplet absorption
spectra and spectral sensitivities of bird cone photoreceptors. Journal of
Comparative Physiology A. 191: 381-392, <a href="https://doi.org/10.1007/s00359-004-0595-3" class="external-link">doi:10.1007/s00359-004-0595-3</a></p>
<p>Hart NS, Partridge JC, Cuthill IC, Bennett AT (2000) Visual
pigments, oil droplets, ocular media and cone photoreceptor distribution in
two species of passerine bird: the blue tit (<em>Parus caeruleus</em> L.) and the
blackbird (<em>Turdus merula</em> L.). J Comp Physiol A 186:375-387,
<a href="https://doi.org/10.1007/s003590050437" class="external-link">doi:10.1007/s003590050437</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre-Paul Bitton <a href="mailto:bittonp@uwindsor.ca">bittonp@uwindsor.ca</a></p>
<p>Chad Eliason <a href="mailto:cme16@zips.uakron.edu">cme16@zips.uakron.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Blue tit visual system based on Hart et al (2000)</span></span></span>
<span class="r-in"><span><span class="va">bluesens</span> <span class="op">&lt;-</span> <span class="fu">sensmodel</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">371</span>, <span class="fl">448</span>, <span class="fl">502</span>, <span class="fl">563</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  lambdacut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">330</span>, <span class="fl">413</span>, <span class="fl">507</span>, <span class="fl">572</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  oiltype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"C"</span>, <span class="st">"Y"</span>, <span class="st">"R"</span><span class="op">)</span>, om <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Danio aequipinnatus based on Govardovskii et al. (2000)</span></span></span>
<span class="r-in"><span><span class="va">daniosens</span> <span class="op">&lt;-</span> <span class="fu">sensmodel</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">357</span>, <span class="fl">411</span>, <span class="fl">477</span>, <span class="fl">569</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas White, Rafael Maia, Hugo Gruson, John Endler, Chad Eliason, Pierre-Paul Bitton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

