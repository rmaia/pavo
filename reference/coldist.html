<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Colour distances — coldist • pavo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Colour distances — coldist"><meta name="description" content="Calculates colour distances. When data are the result of vismodel(), it
applies the receptor-noise model of Vorobyev et al. (1998) to calculate
colour distances with noise based on relative photoreceptor densities. It
also accepts colspace() data in which case unweighted Euclidean distances,
CIE2000 distances (cielab and cielch only), or Manhattan distances (coc model only)
are returned."><meta property="og:description" content="Calculates colour distances. When data are the result of vismodel(), it
applies the receptor-noise model of Vorobyev et al. (1998) to calculate
colour distances with noise based on relative photoreceptor densities. It
also accepts colspace() data in which case unweighted Euclidean distances,
CIE2000 distances (cielab and cielch only), or Manhattan distances (coc model only)
are returned."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pavo</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">2.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pavo.html">Get Started</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://book.colrverse.com"><span class="fa fa-book"></span> Book</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmaia/pavo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Colour distances</h1>
      <small class="dont-index">Source: <a href="https://github.com/rmaia/pavo/blob/master/R/coldist.R" class="external-link"><code>R/coldist.R</code></a></small>
      <div class="d-none name"><code>coldist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates colour distances. When data are the result of <code><a href="vismodel.html">vismodel()</a></code>, it
applies the receptor-noise model of Vorobyev et al. (1998) to calculate
colour distances with noise based on relative photoreceptor densities. It
also accepts <code><a href="colspace.html">colspace()</a></code> data in which case unweighted Euclidean distances,
CIE2000 distances (cielab and cielch only), or Manhattan distances (coc model only)
are returned.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">coldist</span><span class="op">(</span></span>
<span>  <span class="va">modeldata</span>,</span>
<span>  noise <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"neural"</span>, <span class="st">"quantum"</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  achromatic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  qcatch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  weber <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  weber.ref <span class="op">=</span> <span class="st">"longest"</span>,</span>
<span>  weber.achro <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>(required) quantum catch colour data. Can be the result from
<code><a href="vismodel.html">vismodel()</a></code> for noise-weighted Euclidean distances, or <code><a href="colspace.html">colspace()</a></code> for
unweighted (typically) Euclidean distances. Data may also be independently
calculated quantum catches, in the form of a data frame with columns
representing photoreceptors.</p></dd>


<dt id="arg-noise">noise<a class="anchor" aria-label="anchor" href="#arg-noise"></a></dt>
<dd><p>how the noise will be calculated (ignored for <code>colspace</code>
objects):</p><ul><li><p><code>neural</code> (default): noise is proportional to the Weber fraction and is
independent of the intensity of the signal received (i.e. assumes bright
conditions).</p></li>
<li><p><code>quantum</code>: noise is the sum of the neural noise and receptor noise, and
is thus proportional to the Weber fraction and inversely proportional to
the intensity of the signal received (the quantum catches).
Note that the <code>quantum</code> option will only work with objects of
class <code>vismodel</code>.</p></li>
</ul></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>If only some of the comparisons should be returned, a character
vector of length 1 or 2 can be provided, indicating which samples are
desired. The subset vector must match the labels of the input samples, but
partial matching (and regular expressions) are supported.</p></dd>


<dt id="arg-achromatic">achromatic<a class="anchor" aria-label="anchor" href="#arg-achromatic"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, last column of the data frame is used
to calculate the achromatic contrast, the form of which will depend on the
input data and will be indicated by a message during execution. For
noise-weighted distances, noise is based on the Weber fraction given by the
argument <code>weber.achro</code>.</p></dd>


<dt id="arg-qcatch">qcatch<a class="anchor" aria-label="anchor" href="#arg-qcatch"></a></dt>
<dd><p>if the object is of class <code><a href="vismodel.html">vismodel</a></code> or <code><a href="colspace.html">colspace</a></code>, this
argument is ignored. If the object is a data frame of quantal catches from
another source, this argument is used to specify what type of quantum catch
is being used, so that the noise can be calculated accordingly: * <code>Qi</code>:
Quantum catch for each photoreceptor * <code>fi</code>: Quantum catch according to
Fechner's law (the signal of the receptor channel is proportional to the
logarithm of the quantum catch)</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>photoreceptor densities for the cones used in visual modeling. must
have same length as number of columns (excluding achromatic receptor if
used; defaults to the Pekin robin <em>Leiothrix lutea</em> densities:
<code>c(1,2,2,4)</code>). Ignored for <code><a href="colspace.html">colspace</a></code> objects.</p></dd>


<dt id="arg-weber">weber<a class="anchor" aria-label="anchor" href="#arg-weber"></a></dt>
<dd><p>The Weber fraction(s) to be used (often also referred to as
receptor noise, or <em>e</em>). The noise-to-signal ratio <code>v</code> is unknown, and
therefore must be calculated based on the empirically estimated Weber
fraction of one or (more rarely) all the cone classes. When noise is only
known for one receptor, as is typical, <code>v</code> is then applied to estimate the
Weber fraction of the other cones. By default, the value of 0.1 is used
(the empirically estimated value for the LWS cone from <em>Leiothrix lutea</em>).
See Olsson et al. 2017 for a review of published values in the literature.
Ignored for <code>colspace</code> objects.</p></dd>


<dt id="arg-weber-ref">weber.ref<a class="anchor" aria-label="anchor" href="#arg-weber-ref"></a></dt>
<dd><p>the cone class used to obtain the empirical estimate of the
Weber fraction used for the <code>weber</code> argument, if a single value is
specified. By default, <code>n4</code> is used, representing the LWS cone for
<em>Leiothrix lutea</em>. Ignored for <code>colspace</code> objects.</p></dd>


<dt id="arg-weber-achro">weber.achro<a class="anchor" aria-label="anchor" href="#arg-weber-achro"></a></dt>
<dd><p>the Weber fraction to be used to calculate achromatic
contrast, when <code>achromatic = TRUE</code>. Defaults to 0.1. Ignored for <code>colspace</code>
objects.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing up to 4 columns. The first two
(<code>patch1, patch2</code>) refer to the two colors being contrasted; <code>dS</code> is the
chromatic contrast (delta S) and <code>dL</code> is the achromatic contrast (delta L).
Units of <code>dS</code> JND's in the receptor-noise model, unweighted Euclidean
distances in colorspace models, and Manhattan distances in the
colour-opponent-coding space. Units of <code>dL</code> vary, and are either simple
contrast, Weber contrast, or Michelson contrast, as indicated by the output
message.</p>
    </div>
    <div class="section level2">
    <h2 id="note-on-previous-versions">Note on previous versions<a class="anchor" aria-label="anchor" href="#note-on-previous-versions"></a></h2>
    <p>Generic di- tri- and tetra-chromatic
<code>colspace</code> objects were previously passed through the receptor-noise
limited model to return noise-weighted Euclidean distances. This behaviour
has been amended, and generic spaces now return unweighted Euclidean
distances. Equivalent results to the former behaviour can be attained by
sending the results of <code><a href="vismodel.html">vismodel()</a></code> directly to <code>coldist()</code> , as
previously, which also offers greater flexibility and reliability. Thus
<code>coldist()</code> now returns unweighted Euclidean distances for <code>colspace</code>
objects (with the exception of Manhattan distances for the coc space, and CIE2000,
distances for CIELab and CIELCh spaces), and noise-weighted Euclidean distances
for <code>vismodel</code> objects.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vorobyev, M., Osorio, D., Bennett, A., Marshall, N., &amp; Cuthill,
I. (1998). Tetrachromacy, oil droplets and bird plumage colours. Journal Of
Comparative Physiology A-Neuroethology Sensory Neural And Behavioral
Physiology, 183(5), 621-633.</p>
<p>Hart, N. S. (2001). The visual ecology of avian photoreceptors.
Progress In Retinal And Eye Research, 20(5), 675-703.</p>
<p>Endler, J. A., &amp; Mielke, P. (2005). Comparing entire colour
patterns as birds see them. Biological Journal Of The Linnean Society,
86(4), 405-431.</p>
<p>Olsson, P., Lind, O., &amp; Kelber, A. (2015) Bird colour vision:
behavioural thresholds reveal receptor noise. Journal of Experimental
Biology, 218, 184-193.</p>
<p>Lind, O. (2016) Colour vision and background adaptation in a
passerine bird, the zebra finch (Taeniopygia guttata). Royal Society Open
Science, 3, 160383.</p>
<p>Olsson, P., Lind, O., &amp; Kelber, A. (2017) Chromatic and
achromatic vision: parameter choice and limitations for reliable model
predictions. Behavioral Ecology, <a href="https://doi.org/10.1093/beheco/arx133" class="external-link">doi:10.1093/beheco/arx133</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas E. White <a href="mailto:thomas.white026@gmail.com">thomas.white026@gmail.com</a></p>
<p>Rafael Maia <a href="mailto:rm72@zips.uakron.edu">rm72@zips.uakron.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Dichromat</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">flowers</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>, visual <span class="op">=</span> <span class="st">"canis"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">didist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">vis.flowers</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating noise-weighted Euclidean distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trichromat</span></span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>, visual <span class="op">=</span> <span class="st">"apis"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tridist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">vis.flowers</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating noise-weighted Euclidean distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trichromat, colour-hexagon model (euclidean distances)</span></span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>,</span></span>
<span class="r-in"><span>  visual <span class="op">=</span> <span class="st">"apis"</span>, qcatch <span class="op">=</span> <span class="st">"Ei"</span>,</span></span>
<span class="r-in"><span>  relative <span class="op">=</span> <span class="cn">FALSE</span>, vonkries <span class="op">=</span> <span class="cn">TRUE</span>, achromatic <span class="op">=</span> <span class="st">"l"</span>, bkg <span class="op">=</span> <span class="st">"green"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hex.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="colspace.html">colspace</a></span><span class="op">(</span><span class="va">vis.flowers</span>, space <span class="op">=</span> <span class="st">"hexagon"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hexdist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">hex.flowers</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating unweighted Euclidean distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trichromat, colour-opponent-coding model (manhattan distances)</span></span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>, visual <span class="op">=</span> <span class="st">"apis"</span>, qcatch <span class="op">=</span> <span class="st">"Ei"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span>, vonkries <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coc.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="colspace.html">colspace</a></span><span class="op">(</span><span class="va">vis.flowers</span>, space <span class="op">=</span> <span class="st">"coc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hexdist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">coc.flowers</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Manhattan distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Tetrachromat</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sicalis</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vis.sicalis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">sicalis</span>, visual <span class="op">=</span> <span class="st">"avg.uv"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tetradist.sicalis.n</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">vis.sicalis</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating noise-weighted Euclidean distances</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas White, Rafael Maia, Hugo Gruson, John Endler, Chad Eliason, Pierre-Paul Bitton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

