<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Colour distances — coldist • pavo</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Colour distances — coldist"><meta property="og:description" content="Calculates colour distances. When data are the result of vismodel(), it
applies the receptor-noise model of Vorobyev et al. (1998) to calculate
colour distances with noise based on relative photoreceptor densities. It
also accepts colspace() data in which case unweighted Euclidean distances,
CIE2000 distances (cielab and cielch only), or Manhattan distances (coc model only)
are returned."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pavo</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">2.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/pavo.html">Get Started</a>
</li>
<li>
  <a href="https://book.colrverse.com" class="external-link">
    <span class="fa fa-book"></span>
     
    Book
  </a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rmaia/pavo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Colour distances</h1>
    <small class="dont-index">Source: <a href="https://github.com/rmaia/pavo/blob/HEAD/R/coldist.R" class="external-link"><code>R/coldist.R</code></a></small>
    <div class="hidden name"><code>coldist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates colour distances. When data are the result of <code><a href="vismodel.html">vismodel()</a></code>, it
applies the receptor-noise model of Vorobyev et al. (1998) to calculate
colour distances with noise based on relative photoreceptor densities. It
also accepts <code><a href="colspace.html">colspace()</a></code> data in which case unweighted Euclidean distances,
CIE2000 distances (cielab and cielch only), or Manhattan distances (coc model only)
are returned.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">coldist</span><span class="op">(</span></span>
<span>  <span class="va">modeldata</span>,</span>
<span>  noise <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"neural"</span>, <span class="st">"quantum"</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  achromatic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  qcatch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  weber <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  weber.ref <span class="op">=</span> <span class="st">"longest"</span>,</span>
<span>  weber.achro <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>modeldata</dt>
<dd><p>(required) quantum catch colour data. Can be the result from
<code><a href="vismodel.html">vismodel()</a></code> for noise-weighted Euclidean distances, or <code><a href="colspace.html">colspace()</a></code> for
unweighted (typically) Euclidean distances. Data may also be independently
calculated quantum catches, in the form of a data frame with columns
representing photoreceptors.</p></dd>


<dt>noise</dt>
<dd><p>how the noise will be calculated (ignored for <code>colspace</code>
objects):</p><ul><li><p><code>neural</code> (default): noise is proportional to the Weber fraction and is
independent of the intensity of the signal received (i.e. assumes bright
conditions).</p></li>
<li><p><code>quantum</code>: noise is the sum of the neural noise and receptor noise, and
is thus proportional to the Weber fraction and inversely proportional to
the intensity of the signal received (the quantum catches).
Note that the <code>quantum</code> option will only work with objects of
class <code>vismodel</code>.</p></li>
</ul></dd>


<dt>subset</dt>
<dd><p>If only some of the comparisons should be returned, a character
vector of length 1 or 2 can be provided, indicating which samples are
desired. The subset vector must match the labels of the input samples, but
partial matching (and regular expressions) are supported.</p></dd>


<dt>achromatic</dt>
<dd><p>Logical. If <code>TRUE</code>, last column of the data frame is used
to calculate the achromatic contrast, the form of which will depend on the
input data and will be indicated by a message during execution. For
noise-weighted distances, noise is based on the Weber fraction given by the
argument <code>weber.achro</code>.</p></dd>


<dt>qcatch</dt>
<dd><p>if the object is of class <code><a href="vismodel.html">vismodel</a></code> or <code><a href="colspace.html">colspace</a></code>, this
argument is ignored. If the object is a data frame of quantal catches from
another source, this argument is used to specify what type of quantum catch
is being used, so that the noise can be calculated accordingly: * <code>Qi</code>:
Quantum catch for each photoreceptor * <code>fi</code>: Quantum catch according to
Fechner's law (the signal of the receptor channel is proportional to the
logarithm of the quantum catch)</p></dd>


<dt>n</dt>
<dd><p>photoreceptor densities for the cones used in visual modeling. must
have same length as number of columns (excluding achromatic receptor if
used; defaults to the Pekin robin <em>Leiothrix lutea</em> densities:
<code>c(1,2,2,4)</code>). Ignored for <code><a href="colspace.html">colspace</a></code> objects.</p></dd>


<dt>weber</dt>
<dd><p>The Weber fraction(s) to be used (often also referred to as
receptor noise, or <em>e</em>). The noise-to-signal ratio <code>v</code> is unknown, and
therefore must be calculated based on the empirically estimated Weber
fraction of one or (more rarely) all the cone classes. When noise is only
known for one receptor, as is typical, <code>v</code> is then applied to estimate the
Weber fraction of the other cones. By default, the value of 0.1 is used
(the empirically estimated value for the LWS cone from <em>Leiothrix lutea</em>).
See Olsson et al. 2017 for a review of published values in the literature.
Ignored for <code>colspace</code> objects.</p></dd>


<dt>weber.ref</dt>
<dd><p>the cone class used to obtain the empirical estimate of the
Weber fraction used for the <code>weber</code> argument, if a single value is
specified. By default, <code>n4</code> is used, representing the LWS cone for
<em>Leiothrix lutea</em>. Ignored for <code>colspace</code> objects.</p></dd>


<dt>weber.achro</dt>
<dd><p>the Weber fraction to be used to calculate achromatic
contrast, when <code>achromatic = TRUE</code>. Defaults to 0.1. Ignored for <code>colspace</code>
objects.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame containing up to 4 columns. The first two
(<code>patch1, patch2</code>) refer to the two colors being contrasted; <code>dS</code> is the
chromatic contrast (delta S) and <code>dL</code> is the achromatic contrast (delta L).
Units of <code>dS</code> JND's in the receptor-noise model, unweighted Euclidean
distances in colorspace models, and Manhattan distances in the
colour-opponent-coding space. Units of <code>dL</code> vary, and are either simple
contrast, Weber contrast, or Michelson contrast, as indicated by the output
message.</p>
    </div>
    <div id="note-on-previous-versions">
    <h2>Note on previous versions</h2>
    <p>Generic di- tri- and tetra-chromatic
<code>colspace</code> objects were previously passed through the receptor-noise
limited model to return noise-weighted Euclidean distances. This behaviour
has been amended, and generic spaces now return unweighted Euclidean
distances. Equivalent results to the former behaviour can be attained by
sending the results of <code><a href="vismodel.html">vismodel()</a></code> directly to <code>coldist()</code> , as
previously, which also offers greater flexibility and reliability. Thus
<code>coldist()</code> now returns unweighted Euclidean distances for <code>colspace</code>
objects (with the exception of Manhattan distances for the coc space, and CIE2000,
distances for CIELab and CIELCh spaces), and noise-weighted Euclidean distances
for <code>vismodel</code> objects.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Vorobyev, M., Osorio, D., Bennett, A., Marshall, N., &amp; Cuthill,
I. (1998). Tetrachromacy, oil droplets and bird plumage colours. Journal Of
Comparative Physiology A-Neuroethology Sensory Neural And Behavioral
Physiology, 183(5), 621-633.</p>
<p>Hart, N. S. (2001). The visual ecology of avian photoreceptors.
Progress In Retinal And Eye Research, 20(5), 675-703.</p>
<p>Endler, J. A., &amp; Mielke, P. (2005). Comparing entire colour
patterns as birds see them. Biological Journal Of The Linnean Society,
86(4), 405-431.</p>
<p>Olsson, P., Lind, O., &amp; Kelber, A. (2015) Bird colour vision:
behavioural thresholds reveal receptor noise. Journal of Experimental
Biology, 218, 184-193.</p>
<p>Lind, O. (2016) Colour vision and background adaptation in a
passerine bird, the zebra finch (Taeniopygia guttata). Royal Society Open
Science, 3, 160383.</p>
<p>Olsson, P., Lind, O., &amp; Kelber, A. (2017) Chromatic and
achromatic vision: parameter choice and limitations for reliable model
predictions. Behavioral Ecology, <a href="https://doi.org/10.1093/beheco/arx133" class="external-link">doi:10.1093/beheco/arx133</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas E. White <a href="mailto:thomas.white026@gmail.com">thomas.white026@gmail.com</a></p>
<p>Rafael Maia <a href="mailto:rm72@zips.uakron.edu">rm72@zips.uakron.edu</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Dichromat</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">flowers</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>, visual <span class="op">=</span> <span class="st">"canis"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">didist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">vis.flowers</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating noise-weighted Euclidean distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trichromat</span></span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>, visual <span class="op">=</span> <span class="st">"apis"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tridist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">vis.flowers</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating noise-weighted Euclidean distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trichromat, colour-hexagon model (euclidean distances)</span></span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>,</span></span>
<span class="r-in"><span>  visual <span class="op">=</span> <span class="st">"apis"</span>, qcatch <span class="op">=</span> <span class="st">"Ei"</span>,</span></span>
<span class="r-in"><span>  relative <span class="op">=</span> <span class="cn">FALSE</span>, vonkries <span class="op">=</span> <span class="cn">TRUE</span>, achromatic <span class="op">=</span> <span class="st">"l"</span>, bkg <span class="op">=</span> <span class="st">"green"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hex.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="colspace.html">colspace</a></span><span class="op">(</span><span class="va">vis.flowers</span>, space <span class="op">=</span> <span class="st">"hexagon"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hexdist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">hex.flowers</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating unweighted Euclidean distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trichromat, colour-opponent-coding model (manhattan distances)</span></span></span>
<span class="r-in"><span><span class="va">vis.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">flowers</span>, visual <span class="op">=</span> <span class="st">"apis"</span>, qcatch <span class="op">=</span> <span class="st">"Ei"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span>, vonkries <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coc.flowers</span> <span class="op">&lt;-</span> <span class="fu"><a href="colspace.html">colspace</a></span><span class="op">(</span><span class="va">vis.flowers</span>, space <span class="op">=</span> <span class="st">"coc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hexdist.flowers</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">coc.flowers</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Manhattan distances</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Tetrachromat</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sicalis</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vis.sicalis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">sicalis</span>, visual <span class="op">=</span> <span class="st">"avg.uv"</span>, relative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tetradist.sicalis.n</span> <span class="op">&lt;-</span> <span class="fu">coldist</span><span class="op">(</span><span class="va">vis.sicalis</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating noise-weighted Euclidean distances</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas White, Rafael Maia, Hugo Gruson, John Endler, Chad Eliason, Pierre-Paul Bitton.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '1988255e7e235678bc3c7f1b86b9ecc5',
    indexName: 'rafaelmaia_pavo',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

