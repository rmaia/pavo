<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Colour volume overlap — voloverlap • pavo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Colour volume overlap — voloverlap"><meta name="description" content="Calculates the overlap between the volumes defined by two sets of points in cartesian
space."><meta property="og:description" content="Calculates the overlap between the volumes defined by two sets of points in cartesian
space."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pavo</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">2.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/pavo.html">Get Started</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://book.colrverse.com"><span class="fa fa-book"></span> Book</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmaia/pavo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Colour volume overlap</h1>
      <small class="dont-index">Source: <a href="https://github.com/rmaia/pavo/blob/master/R/voloverlap.R" class="external-link"><code>R/voloverlap.R</code></a></small>
      <div class="d-none name"><code>voloverlap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the overlap between the volumes defined by two sets of points in cartesian
space.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">voloverlap</span><span class="op">(</span></span>
<span>  <span class="va">colsp1</span>,</span>
<span>  <span class="va">colsp2</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"convex"</span>, <span class="st">"alpha"</span><span class="op">)</span>,</span>
<span>  avalue <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgrey"</span><span class="op">)</span>,</span>
<span>  fill <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  new <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nsamp <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  psize <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-colsp-colsp-">colsp1, colsp2<a class="anchor" aria-label="anchor" href="#arg-colsp-colsp-"></a></dt>
<dd><p>(required) data frame, possibly a result from the <code><a href="colspace.html">colspace()</a></code>
function, containing
values for the 'x', 'y' (and possibly 'z') coordinates as columns (labeled as such)</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>if "convex", the colour volume is plotted using a convex hull
and if "alpha", it is plotted using alphashapes.</p></dd>


<dt id="arg-avalue">avalue<a class="anchor" aria-label="anchor" href="#arg-avalue"></a></dt>
<dd><p>if <code>type = alpha</code>, the alpha parameter values for <code>colsp1</code> and
<code>colsp2</code> respectively to compute the alphashapes. Can be a numeric of length
one if the same value is used in both cases. <code>avalue = "auto"</code> (default)
finds and use the \(\alpha^*\) value as defined in Gruson (2020).</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical. Should the volumes and points be plotted? (defaults to <code>FALSE</code>).
This only works for tetrahedral colourspaces at the moment.</p></dd>


<dt id="arg-interactive">interactive<a class="anchor" aria-label="anchor" href="#arg-interactive"></a></dt>
<dd><p>logical. If <code>TRUE</code>, uses the rgl engine for interactive plotting;
if <code>FALSE</code> then a static plot is generated.</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>a vector of length 3 with the colours for (in order) the first volume,
the second volume, and the overlap.</p></dd>


<dt id="arg-fill">fill<a class="anchor" aria-label="anchor" href="#arg-fill"></a></dt>
<dd><p>logical. should the two volumes be filled in the plot? (defaults to <code>FALSE</code>)</p></dd>


<dt id="arg-new">new<a class="anchor" aria-label="anchor" href="#arg-new"></a></dt>
<dd><p>logical. Should a new plot window be called? If <code>FALSE</code>, volumes and their
overlap are plotted over the current plot (defaults to <code>TRUE</code>).</p></dd>


<dt id="arg-nsamp">nsamp<a class="anchor" aria-label="anchor" href="#arg-nsamp"></a></dt>
<dd><p>if <code>type = "alpha"</code>, the number of points to be sampled for the
Monte Carlo computation. Stoddard &amp; Stevens(2011) use around 750,000 points,
but more or fewer might be required depending on the
degree of overlap.</p></dd>


<dt id="arg-psize">psize<a class="anchor" aria-label="anchor" href="#arg-psize"></a></dt>
<dd><p>if <code>type = "alpha"</code> and <code>plot = TRUE</code>, sets the size to plot the points
used in the Monte Carlo computation.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>if <code>plot = TRUE</code>, sets the line width for volume grids.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to the plot. See <code><a href="vol.html">vol()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Calculates the overlap between the volumes defined by two set of points in
colourspace. The volume from the overlap is then given relative to:</p><ul><li><p><code>vsmallest</code> the volume of the overlap divided by the smallest of that defined
by the the two input sets of colour points. Thus, if one of the volumes is entirely
contained within the other, this overlap will be <code>vsmallest = 1</code>.</p></li>
<li><p><code>vboth</code> the volume of the overlap divided by the combined volume of both
input sets of colour points.
If <code>type = "alpha"</code>, If used, the output will be different:</p></li>
<li><p><code>s_in1, s_in2</code> the number of sampled points that fall within each of the volumes
individually.</p></li>
<li><p><code>s_inboth</code> the number of sampled points that fall within both volumes.</p></li>
<li><p><code>s_ineither</code> the number of points that fall within either of the volumes.</p></li>
<li><p><code>psmallest</code> the proportion of points that fall within both volumes divided by the
number of points that fall within the smallest volume.</p></li>
<li><p><code>pboth</code> the proportion of points that fall within both volumes divided by the total
number of points that fall within both volumes.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Stoddard &amp; Stevens (2011) originally obtained the volume overlap through Monte Carlo
simulations of points within the range of the volumes, and obtaining the frequency of
simulated values that fall inside the volumes defined by both sets of colour points.</p>
<p>Stoddard &amp; Stevens (2011) also return the value of the overlap relative to one of
the volumes (in that case, the host species). However, for other applications
this value may not be what one expects to obtain if (1) the two
volumes differ considerably in size, or (2) one of the volumes is entirely contained
within the other. For this reason, we also report the volume relative to the union of
the two input volumes, which may be more adequate in most cases.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stoddard, M. C., &amp; Prum, R. O. (2008). Evolution of avian plumage color
in a tetrahedral color space: A phylogenetic analysis of new world buntings. The
American Naturalist, 171(6), 755-776.</p>
<p>Stoddard, M. C., &amp; Stevens, M. (2011). Avian vision and the evolution of
egg color mimicry in the common cuckoo. Evolution, 65(7), 2004-2013.</p>
<p>Maia, R., White, T. E., (2018) Comparing colors using visual models.
Behavioral Ecology, ary017 <a href="https://doi.org/10.1093/beheco/ary017" class="external-link">doi:10.1093/beheco/ary017</a></p>
<p>Gruson H. (2020). Estimation of colour volumes as concave hypervolumes using
\(\alpha\)-shapes. Methods in Ecology and Evolution, 11(8), 955-963
<a href="https://doi.org/10.1111/2041-210X.13398" class="external-link">doi:10.1111/2041-210X.13398</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rafael Maia <a href="mailto:rm72@zips.uakron.edu">rm72@zips.uakron.edu</a></p>
<p>Hugo Gruson <a href="mailto:hugo.gruson+R@normalesup.org">hugo.gruson+R@normalesup.org</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sicalis</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tcs.sicalis.C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="colspace.html">colspace</a></span><span class="op">(</span><span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">sicalis</span><span class="op">)</span><span class="op">)</span>, <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tcs.sicalis.T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="colspace.html">colspace</a></span><span class="op">(</span><span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">sicalis</span><span class="op">)</span><span class="op">)</span>, <span class="st">"T"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tcs.sicalis.B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="colspace.html">colspace</a></span><span class="op">(</span><span class="fu"><a href="vismodel.html">vismodel</a></span><span class="op">(</span><span class="va">sicalis</span><span class="op">)</span><span class="op">)</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convex hull volume</span></span></span>
<span class="r-in"><span><span class="fu">voloverlap</span><span class="op">(</span><span class="va">tcs.sicalis.T</span>, <span class="va">tcs.sicalis.B</span>, type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           vol1         vol2   overlapvol vsmallest      vboth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 5.183721e-06 6.281511e-06 6.904074e-07 0.1331876 0.06407598</span>
<span class="r-in"><span><span class="fu">voloverlap</span><span class="op">(</span><span class="va">tcs.sicalis.T</span>, <span class="va">tcs.sicalis.C</span>, type <span class="op">=</span> <span class="st">"convex"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="voloverlap-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           vol1         vol2 overlapvol vsmallest vboth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 5.183721e-06 4.739152e-06          0         0     0</span>
<span class="r-in"><span><span class="fu">voloverlap</span><span class="op">(</span><span class="va">tcs.sicalis.T</span>, <span class="va">tcs.sicalis.C</span>, type <span class="op">=</span> <span class="st">"convex"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="voloverlap-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           vol1         vol2 overlapvol vsmallest vboth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 5.183721e-06 4.739152e-06          0         0     0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alpha-shape volume</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"alphashape3d"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">voloverlap</span><span class="op">(</span><span class="va">tcs.sicalis.T</span>, <span class="va">tcs.sicalis.B</span>, type <span class="op">=</span> <span class="st">"alpha"</span>, avalue <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           vol1         vol2 s_in1 s_in2 s_inboth s_ineither psmallest pboth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 5.183721e-06 6.231493e-06    12    15        3         24      0.25 0.125</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas White, Rafael Maia, Hugo Gruson, John Endler, Chad Eliason, Pierre-Paul Bitton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

